# Nanorave MinION Genomic Analysis - R Script Pipeline

```bash
cd analysis/script
```

This directory contains a suite of R scripts used for processing and visualizing results from a **Nanopore sequencing run** using **Clair3-diploid** outputs. Each script corresponds to a specific stage in the analysis pipeline for a given MinION run.

---

## ğŸ”¹ R1_script_for_amplicon_coverage_from_nanorave_clair3_diploid_output.R

### ğŸ“Œ Purpose
Computes and summarizes **amplicon coverage** statistics per sample and amplicon from Clair3-diploid outputs (e.g., BAM files and related coverage tables).

### â–¶ï¸ Usage
```bash
Rscript R1_script_for_amplicon_coverage_from_nanorave_clair3_diploid_output.R -m GAMP_22906B2 -g clair3_diploid_2 -d 20250511 -a /path/to/output/
````

### ğŸ“¥ Required Parameters

* `-m`: MinION run name (e.g., `GAMP_22906B2`)
* `-g`: Genotyping method (e.g., `clair3_diploid_2`)
* `-d`: Analysis date in YYYYMMDD format (e.g., `20250511`)
* `-a`: Path to the output directory

---

## ğŸ”¹ R2\_script\_for\_vcf\_processing\_from\_nanorave\_clair3\_diploid\_output.R

### ğŸ“Œ Purpose

Processes VCF files generated by Clair3-diploid, links variant data with metadata, filters key SNPs, assigns haplotypes (e.g., **dhfr**, **dhps**), and creates genotype matrices and genetic report cards.

### â–¶ï¸ Usage

```bash
Rscript R2_script_for_vcf_processing_from_nanorave_clair3_diploid_output.R -m GAMP_22906B2 -g clair3_diploid_2 -d 20250511 -a /path/to/output/
```

### ğŸ“¦ Outputs

* Filtered variant tables
* Genotype matrices (wide & long formats)
* Haplotypes and resistance predictions
* Annotated K13 variants
* CSP genotype tables

---

## ğŸ”¹ R3\_script\_for\_coverage\_plot\_MinION\_run\_B2.R

### ğŸ“Œ Purpose

Generates **coverage summary plots** for the MinION run (e.g., depth per amplicon/sample, missing coverage diagnostics).

### â–¶ï¸ Usage

```bash
Rscript R3_script_for_coverage_plot_MinION_run_B2.R
```

> âš ï¸ Assumes processed coverage tables already exist from **R1\_script**.

### ğŸ“Š Output

* PDF/PNG plots of per-amplicon/sample coverage

---

## ğŸ”¹ R4\_script\_for\_plotting\_drug\_resistance\_frequencies\_MinION\_run\_B2.R

### ğŸ“Œ Purpose

Plots **drug resistance haplotype frequencies** (e.g., dhfr, dhps) and **ART/CQ/PYR/SX** resistance markers across all samples in the run.

### â–¶ï¸ Usage

```bash
Rscript R4_script_for_plotting_drug_resistance_frequencies_MinION_run_B2.R
```

> âš ï¸ Requires output from **R2\_script** (`genotype_calls_haplotypes_samplerows_v2.csv`).

### ğŸ“Š Output

* Barplots of haplotype frequency
* Resistance profile summaries

---

## ğŸ“ Output Directory Structure

```
output/
â””â”€â”€ GAMP_22906B2/
    â””â”€â”€ clair3_diploid_2/
        â”œâ”€â”€ genotypes/
        â”‚   â”œâ”€â”€ *_variant_info.csv
        â”‚   â”œâ”€â”€ *_genotype_matrix.csv
        â”‚   â””â”€â”€ *_haplotypes_samplerows.csv
        â””â”€â”€ plots/
            â”œâ”€â”€ coverage/
            â””â”€â”€ drug_resistance/
```

---

## âœï¸ Notes

* Ensure all required input files (VCF, metadata, reference annotations) are present before running.
* Scripts are modular but meant to be run in order (R1 â†’ R2 â†’ R3 â†’ R4).
* Developed for malaria genomic surveillance using Oxford Nanopore data.


